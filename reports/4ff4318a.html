<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Analysis - modelcontextprotocol/server-filesystem | Credence Registry</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
        }
        .header-content {
            max-width: 1000px;
            margin: 0 auto;
        }
        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        .header .server-id {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            opacity: 0.9;
        }
        .container {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        .summary-card {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        .status-banner {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        .status-icon { font-size: 3rem; }
        .status-text h2 { color: #856404; margin-bottom: 0.5rem; }
        .status-text p { color: #856404; }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .metric {
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: center;
        }
        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
        }
        .metric-label {
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .section {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }
        .section h2 {
            margin-bottom: 1rem;
            color: #667eea;
        }
        .finding {
            padding: 1rem;
            background: #f8f9fa;
            border-left: 3px solid #ffc107;
            margin-bottom: 1rem;
            border-radius: 4px;
        }
        .finding-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .badge { display: inline-block; margin: 1rem 0; }
        code {
            background: #f4f4f4;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .vote-distribution {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
        }
        .vote-bar {
            flex: 1;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-weight: bold;
            color: white;
        }
        .vote-believers { background: #28a745; }
        .vote-skeptics { background: #dc3545; }
        .vote-neutrals { background: #6c757d; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>üîí MCP Server Security Analysis</h1>
            <div class="server-id">modelcontextprotocol/server-filesystem</div>
        </div>
    </div>

    <div class="container">
        <div class="summary-card">
            <div class="status-banner">
                <div class="status-icon">‚ö†Ô∏è</div>
                <div class="status-text">
                    <h2>FLAGGED FOR CONDITIONAL DEPLOYMENT</h2>
                    <p>Trust Score: 0.62/1.0 | Confidence: 85%</p>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric">
                    <div class="metric-value">22</div>
                    <div class="metric-label">SAST Findings</div>
                </div>
                <div class="metric">
                    <div class="metric-value">0</div>
                    <div class="metric-label">Known CVEs</div>
                </div>
                <div class="metric">
                    <div class="metric-value">0</div>
                    <div class="metric-label">Secrets Found</div>
                </div>
                <div class="metric">
                    <div class="metric-value">0.62</div>
                    <div class="metric-label">Trust Score</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üìã Analysis Summary</h2>
            <p><strong>Analysis ID:</strong> <code>4ff4318a</code></p>
            <p><strong>Analyzed:</strong> December 28, 2025</p>
            <p><strong>Git Commit:</strong> <code>dcb47d2</code> (Dec 19, 2025)</p>
            <p><strong>Package Hash:</strong> <code>9c3d7d8913ab8371...</code></p>
        </div>

        <div class="section">
            <h2>ü§ñ ThinkTank Multi-Agent Consensus</h2>
            <p><strong>Verdict:</strong> FLAGGED</p>
            <p><strong>Agents:</strong> 8 AI security experts (3 Believers, 3 Skeptics, 2 Neutrals)</p>
            <p><strong>Confidence:</strong> 85%</p>
            
            <div class="vote-distribution">
                <div class="vote-bar vote-believers">3 Believers</div>
                <div class="vote-bar vote-skeptics">3 Skeptics</div>
                <div class="vote-bar vote-neutrals">2 Neutrals</div>
            </div>

            <p style="margin-top: 1.5rem;"><strong>Consensus Summary:</strong></p>
            <p>The filesystem MCP server presents moderate security concerns that require remediation and operational controls before production deployment. While the automated scan detected 22 SAST findings with zero known CVEs, the inherent architectural risks of filesystem access, combined with insufficient visibility into the nature of these findings, warrant a cautious approach. This server can be safely deployed in controlled environments with appropriate security controls, but should not be exposed to untrusted users or networks without significant hardening.</p>
        </div>

        <div class="section">
            <h2>üîç Key Findings</h2>
            <div class="finding">
                <div class="finding-title">22 SAST Findings Require Review</div>
                <p>Comprehensive review and triage needed. Absence of CVE mappings suggests code quality issues rather than actively exploited vulnerabilities.</p>
            </div>
            <div class="finding">
                <div class="finding-title">Filesystem Access = Inherent Risk</div>
                <p>Any service providing programmatic filesystem access creates significant attack surface for path traversal and unauthorized file access.</p>
            </div>
            <div class="finding">
                <div class="finding-title">Conditional Deployment Recommended</div>
                <p>Can be safely deployed in controlled environments with appropriate security controls.</p>
            </div>
            <div class="finding">
                <div class="finding-title">Not Ready for Untrusted Users</div>
                <p>Should not be exposed to untrusted users or networks without significant hardening.</p>
            </div>
        </div>

        <div class="section">
            <h2>üõ†Ô∏è Security Scan Tools Used</h2>
            <ul style="list-style-position: inside;">
                <li><strong>Semgrep</strong> - Multi-language SAST (22 findings)</li>
                <li><strong>Bandit</strong> - Python-specific security linter</li>
                <li><strong>GitLeaks</strong> - Secret detection (0 secrets)</li>
                <li><strong>Syft</strong> - SBOM generation</li>
                <li><strong>Trivy</strong> - Vulnerability scanning (0 CVEs)</li>
            </ul>
        </div>

        <div class="section">
            <h2>üí° Recommendations</h2>
            <ol style="list-style-position: inside; line-height: 2;">
                <li>Review and triage all 22 SAST findings</li>
                <li>Implement path traversal protections</li>
                <li>Add input validation hardening</li>
                <li>Deploy only in controlled environments initially</li>
                <li>Do not expose to untrusted users without additional security controls</li>
            </ol>
        </div>

        <div class="section">
            <h2>üè∑Ô∏è Verification Badge</h2>
            <p>Add this badge to your README:</p>
            <div class="badge">
                <img src="../badges/modelcontextprotocol-server-filesystem.svg" alt="Credence Security Badge">
            </div>
            <p><strong>Markdown:</strong></p>
            <code style="display: block; padding: 1rem; background: #f4f4f4; margin: 0.5rem 0;">
[![Credence Security](https://[your-registry-url]/badges/modelcontextprotocol-server-filesystem.svg)](https://[your-registry-url]/reports/4ff4318a.html)
            </code>
        </div>

        <div class="section">
            <h2>üìä Technical Details</h2>
            <p><strong>Static Analysis:</strong> Failed (22 issues)</p>
            <p><strong>Dependency Analysis:</strong> Passed (0 vulnerabilities)</p>
            <p><strong>SBOM Generated:</strong> Yes</p>
            <p><strong>Analysis Runtime:</strong> 17.45 seconds</p>
            <p><strong>Trust Score Range:</strong> 0.48 - 0.72 across agents</p>
        </div>

        <div style="text-align: center; padding: 2rem; color: #666;">
            <p>Powered by <strong>ThinkTank Multi-Agent Analysis</strong> &amp; <strong>Credence Security Registry</strong></p>
            <p style="margin-top: 0.5rem;">Analysis ID: 4ff4318a | Generated: Dec 28, 2025</p>
        </div>
    </div>
</body>
</html>
